<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üìÖ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©</title>
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/2921/2921222.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;500;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg-color: #fff5f8;
      --text-color: #333;
      --card-bg: #ffeef5;
      --card-shadow: rgba(255, 132, 173, 0.2);
      --header-bg: #ec5c94;
      --header-text: #fff;
      --button-bg: #ff80ab;
      --button-bg-hover: #ec5c94;
      --cell-border: #f8a5c2;
    }
    .dark {
      --bg-color: #121212;
      --text-color: #e0e0e0;
      --card-bg: #1f1f1f;
      --card-shadow: rgba(0,0,0,0.5);
      --header-bg: #1f1f1f;
      --header-text: #e0e0e0;
      --button-bg: #444;
      --button-bg-hover: #555;
      --cell-border: #444;
    }
    body {
      font-family: 'Kanit', sans-serif;
      background: var(--bg-color);
      margin: 0;
      padding: 20px;
      color: var(--text-color);
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background: var(--card-bg);
      border-radius: 8px;
      box-shadow: 0 4px 8px var(--card-shadow);
    }
    h1 {
      color: var(--header-bg);
      text-align: center;
    }
    a.back {
      display: inline-block;
      margin-bottom: 15px;
      background: var(--header-bg);
      color: var(--header-text);
      padding: 8px 12px;
      border-radius: 6px;
      text-decoration: none;
    }
    #holiday-form {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr auto;
      gap: 10px;
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid var(--cell-border);
      border-radius: 8px;
    }
    input, button {
      padding: 8px;
      border: 1px solid var(--cell-border);
      border-radius: 4px;
      background: var(--bg-color);
      color: var(--text-color);
    }
    button {
      background: var(--button-bg);
      color: var(--header-text);
      cursor: pointer;
      border: none;
      transition: background 0.2s;
    }
    button:hover {
      background: var(--button-bg-hover);
    }
    #holiday-list {
      list-style: none;
      padding: 0;
    }
    .holiday-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid var(--cell-border);
    }
    .holiday-item:last-child {
      border-bottom: none;
    }
    .holiday-item span {
      flex: 1;
    }
    .holiday-item .actions {
      display: flex;
      gap: 5px;
    }
    .delete-btn {
      background: #e74c3c;
    }
    .delete-btn:hover {
      background: #c0392b;
    }
    @media (max-width: 600px) {
      #holiday-form {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
    <h1>üìÖ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©</h1>

    <h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà</h3>
    <form id="holiday-form">
      <input type="date" id="holiday-date" required />
      <input type="text" id="holiday-th" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î (‡πÑ‡∏ó‡∏¢)" required />
      <input type="text" id="holiday-en" placeholder="Holiday Name (English)" required />
      <button type="submit">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
    </form>

    <h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î</h3>
    <ul id="holiday-list"></ul>
  </div>

  <script>
    // ** ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô URL ‡∏Ç‡∏≠‡∏á Backend ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì Deploy ‡∏ö‡∏ô Render **
    const RENDER_BACKEND_URL = 'https://ub-backend.onrender.com';

    const holidayForm = document.getElementById('holiday-form');
    const holidayList = document.getElementById('holiday-list');

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏à‡∏≤‡∏Å API
    async function fetchHolidays() {
      try {
        const response = await fetch(`${RENDER_BACKEND_URL}/api/holidays`);
        const holidays = await response.json();
        renderHolidays(holidays);
      } catch (error) {
        console.error('Error fetching holidays:', error);
        holidayList.innerHTML = '<li>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÑ‡∏î‡πâ</li>';
      }
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
    function renderHolidays(holidays) {
      holidayList.innerHTML = '';
      holidays.sort((a, b) => new Date(a.date) - new Date(b.date));
      holidays.forEach(h => {
        const li = document.createElement('li');
        li.className = 'holiday-item';
        li.innerHTML = `
          <span><strong>${h.date}</strong>: ${h.th} (${h.en})</span>
          <div class="actions">
            <button class="delete-btn" data-id="${h._id}">‡∏•‡∏ö</button>
          </div>
        `;
        holidayList.appendChild(li);
      });
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà
    holidayForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const date = document.getElementById('holiday-date').value;
      const th = document.getElementById('holiday-th').value;
      const en = document.getElementById('holiday-en').value;
      
      try {
        const response = await fetch(`${RENDER_BACKEND_URL}/api/holidays`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ date, th, en })
        });
        if (response.ok) {
          alert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
          holidayForm.reset();
          fetchHolidays();
        } else {
          const error = await response.json();
          alert(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`);
        }
      } catch (error) {
        console.error('Error adding holiday:', error);
        alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÑ‡∏î‡πâ');
      }
    });

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î
    holidayList.addEventListener('click', async (e) => {
      if (e.target.classList.contains('delete-btn')) {
        const holidayId = e.target.dataset.id;
        if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
          try {
            const response = await fetch(`${RENDER_BACKEND_URL}/api/holidays/${holidayId}`, {
              method: 'DELETE'
            });
            if (response.ok) {
              alert('‡∏•‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
              fetchHolidays();
            } else {
              const error = await response.json();
              alert(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`);
            }
          } catch (error) {
            console.error('Error deleting holiday:', error);
            alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÑ‡∏î‡πâ');
          }
        }
      }
    });
    
    // ‡πÇ‡∏´‡∏•‡∏î‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
    document.addEventListener('DOMContentLoaded', fetchHolidays);
  </script>
</body>
</html>